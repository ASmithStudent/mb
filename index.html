<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <meta name="description" content="Course page for Mission Bit at Gateway HS">
    <meta name="author" content="Greg Gorlen">
    <meta name="keywords" content="mission, bit, gateway">
    <link rel='shortcut icon' href='favicon.ico' type='image/x-icon'/>
    <title>Mission Bit at Gateway HS</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">

  </head>
  <body>

    <nav>
      <a href="modules/">Modules</a>
      <a href="resources/">Resources</a>
      <a href="projects/">Projects</a>
      <a href="about/">About</a>
    </nav>
    <header style="margin-left: 10em;">
      <h1>Mission Bit at Gateway HS</h1>
    </header>
    <main> &nbsp;</main>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js">
    </script>

    <!-- Global JS script -->
    <script src="js/global.js"></script>
    

    <script>
      "use strict";

      const rad = d => d * Math.PI / 180;
      const deg = r => r / Math.PI * 180; /// TODO
      const canvas = document.createElement("canvas");
      canvas.width = parseInt(getComputedStyle(document.body).width);
      const headerHeight = parseInt(getComputedStyle(document.getElementsByTagName("header")[0]).height);
      canvas.height = innerHeight - headerHeight;
      //document.body.appendChild(canvas);
      const ctx = canvas.getContext("2d");
      const size = (Math.min(canvas.width, canvas.height) / 80 | 0) || 5;
      const ships = [];
      const mouse = { x: canvas.width / 2, y: canvas.height / 2 };

      const Ship = function (x, y, size, angle) {
        this.x = x; 
        this.y = y;
        this.size = size;
        this.angle = angle;
      };

      Ship.prototype.move = function (x, y) {
        const angleRad = Math.atan2(y - this.y, x - this.x);
//        console.log(angleRad);
        const dx = x - this.x;
        const dy = y - this.y;
        const d = Math.sqrt(dx * dx + dy * dy);
        //this.x = this.x + Math.cos(angleRad) * d / 50;
        //this.y = this.y + Math.sin(angleRad) * d / 50;
        //this.angle = angleRad;
      };

      Ship.prototype.draw = function (ctx) {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.angle);
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(0, this.size);
        ctx.moveTo(0, 0);
        ctx.lineTo(0, -this.size);
        ctx.lineTo(this.size * 3, 0);
        ctx.lineTo(0, this.size);

        ctx.stroke();
        ctx.restore();
      };

      (function init() {
        for (let i = 0; i < 1; i++) {
          ships.push(new Ship(
            Math.random() * canvas.width, 
            Math.random() * canvas.height, 
            size, rad(Math.random() * 360))
          );
        }

        document.addEventListener("mousemove", e => {
          mouse.x = e.pageX;
          mouse.y = e.pageY;
        });
      })();

      (function update() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (const ship of ships) {
          ship.move(mouse.x, mouse.y);
          ship.draw(ctx);
        }

        requestAnimationFrame(update);
      })();
    </script>
  </body>
</html>
